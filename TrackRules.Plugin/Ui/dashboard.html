<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Track Rules</title>
    <style>
      .trackrules-dashboard {
        padding: 1.5em;
      }

      .trackrules-flex {
        display: flex;
        flex-wrap: wrap;
        gap: 1em;
      }

      .trackrules-panel {
        flex: 1 1 320px;
        background: rgba(255, 255, 255, 0.03);
        border-radius: 8px;
        padding: 1em 1.2em;
        border: 1px solid rgba(255, 255, 255, 0.08);
      }

      .trackrules-panel h3 {
        margin-top: 0;
      }

      .trackrules-field {
        margin-bottom: 0.8em;
      }

      .trackrules-field label {
        display: block;
        margin-bottom: 0.25em;
        font-weight: 600;
      }

      .trackrules-field input,
      .trackrules-field select,
      .trackrules-field textarea {
        width: 100%;
        box-sizing: border-box;
      }

      .trackrules-badge {
        display: inline-block;
        padding: 0.2em 0.6em;
        border-radius: 999px;
        font-size: 0.85em;
        background: rgba(255, 255, 255, 0.12);
        margin-right: 0.4em;
      }

      .trackrules-rule-list {
        margin-top: 1em;
      }

      .trackrules-rule-card {
        border: 1px solid rgba(255, 255, 255, 0.12);
        border-radius: 6px;
        padding: 0.8em;
        margin-bottom: 0.8em;
        background: rgba(255, 255, 255, 0.02);
      }

      .trackrules-rule-card header {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .trackrules-actions {
        display: flex;
        gap: 0.8em;
        flex-wrap: wrap;
      }

      .trackrules-status {
        margin-top: 0.6em;
      }

      .trackrules-series-results {
        max-height: 140px;
        overflow: auto;
        border: 1px solid rgba(255, 255, 255, 0.12);
        border-radius: 4px;
        margin-top: 0.4em;
      }

      .trackrules-series-result {
        padding: 0.35em 0.6em;
        cursor: pointer;
      }

      .trackrules-series-result:hover {
        background: rgba(255, 255, 255, 0.08);
      }
    </style>
  </head>
  <body>
    <div
      id="trackRulesConfigPage"
      data-role="page"
      class="page type-interior pluginConfigurationPage"
      data-title="Track Rules"
    >
      <div class="content-primary trackrules-dashboard">
        <div class="trackrules-panel">
          <h2>User selection</h2>
          <div class="trackrules-field">
            <label for="trackrulesUserSelect">User</label>
            <select
              id="trackrulesUserSelect"
              class="emby-select trackrules-user-select"
            ></select>
          </div>
          <div class="trackrules-field">
            <button is="emby-button" type="button" class="raised button-raised trackrules-refresh">
              Reload rules
            </button>
          </div>
          <div class="trackrules-status trackrules-user-status"></div>
        </div>

        <div class="trackrules-panel">
          <h2>Rule editor</h2>
          <div class="trackrules-field">
            <label for="trackrulesScope">Scope</label>
            <select
              id="trackrulesScope"
              class="emby-select trackrules-scope"
            >
              <option value="0">Global</option>
              <option value="1">Library</option>
              <option value="2">Series</option>
            </select>
          </div>

          <div class="trackrules-field trackrules-target-library">
            <label for="trackrulesLibrary">Library</label>
            <select
              id="trackrulesLibrary"
              class="emby-select trackrules-library"
            ></select>
          </div>

          <div class="trackrules-field trackrules-target-series">
            <label for="trackrulesSeriesSearch">Series</label>
            <input
              id="trackrulesSeriesSearch"
              type="text"
              class="emby-input trackrules-series-search"
              placeholder="Search by nameâ€¦"
            />
            <input type="hidden" class="trackrules-series-id" />
            <div class="trackrules-series-results hide"></div>
          </div>

          <div class="trackrules-field">
            <label for="trackrulesAudio">Audio priorities</label>
            <input
              id="trackrulesAudio"
              type="text"
              class="emby-input trackrules-audio"
              placeholder="e.g. eng,jpn,any"
            />
          </div>

          <div class="trackrules-field">
            <label for="trackrulesSubs">Subtitle priorities</label>
            <input
              id="trackrulesSubs"
              type="text"
              class="emby-input trackrules-subs"
              placeholder="e.g. none,eng"
            />
          </div>

          <div class="trackrules-field">
            <label for="trackrulesSubsMode">Subtitle mode</label>
            <select
              id="trackrulesSubsMode"
              class="emby-select trackrules-subs-mode"
            >
              <option value="1">Default</option>
              <option value="2">Prefer forced</option>
              <option value="3">Always show</option>
              <option value="4">Only if audio differs</option>
              <option value="0">Never enable</option>
            </select>
          </div>

          <div class="trackrules-field">
            <label class="checkboxLabel">
              <input type="checkbox" class="trackrules-dont-transcode" />
              <span>Don't transcode when applying</span>
            </label>
          </div>

          <div class="trackrules-field">
            <label class="checkboxLabel">
              <input type="checkbox" class="trackrules-enabled" checked />
              <span>Rule enabled</span>
            </label>
          </div>

          <div class="trackrules-actions">
            <button is="emby-button" type="button" class="raised button-raised trackrules-save">
              Save rule
            </button>
            <button is="emby-button" type="button" class="button-flat trackrules-reset-form">
              Clear form
            </button>
          </div>
          <div class="trackrules-status trackrules-editor-status"></div>
        </div>

        <div class="trackrules-panel trackrules-rules-panel">
          <h2>Existing rules</h2>
          <p>
            Rules are evaluated per user with precedence:
            <span class="trackrules-badge">Series</span>
            <span class="trackrules-badge">Library</span>
            <span class="trackrules-badge">Global</span>
          </p>
          <div class="trackrules-rule-list"></div>
        </div>
      </div>
    </div>

    <script src="dashboard.js"></script>
  </body>
</html>
